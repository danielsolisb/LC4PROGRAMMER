<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LC4 Programmer</title>
    <link rel="stylesheet" href="/web/css/style.css">

    <!-- ======================================================= -->
    <!-- NUEVO: Añadir las librerías del mapa aquí -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- ======================================================= -->

</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="/assets/img/cormar_logo.png" alt="Logo Cormar" class="sidebar-logo">
                <span>LC4 Programmer</span>
                <button class="back-button" onclick="goBackToWelcome()" title="Volver a la pantalla de inicio">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                </button>
            </div>
            <nav class="sidebar-nav">
                <a href="#" id="nav-dashboard" class="active" onclick="loadView('dashboard')">Dashboard</a>
                <a href="#" id="nav-sequences" onclick="loadView('sequences')">Editor de Secuencias</a>
                <a href="#" id="nav-plans" onclick="loadView('plans')">Programador de Planes</a>
                <a href="#" id="nav-config" onclick="loadView('config')">Configuración</a>
                <a href="#" id="nav-monitoring" onclick="loadView('monitoring')">Monitoreo en Tiempo Real</a>
                <a href="#" id="nav-plan-visualizer" onclick="loadView('plan-visualizer')">Visualizador de Planes</a>
            </nav>
            <div class="sidebar-footer">
                <a href="#" onclick="handleSaveGlobal()">Guardar Global</a>
                <a href="#">Subir al Controlador</a>
                <a href="#" id="btn-disconnect-app" onclick="handleAppDisconnect()">Desconectar</a>
                <div id="app-status-indicator" class="status-indicator disconnected">
                    Desconectado
                </div>
            </div>
        </aside>

        <main id="main-content-area" class="main-content">
            <!-- El contenido de las vistas se carga aquí -->
        </main>
    </div>
    <!-- Modal de Carga -->
    <div id="loading-modal" class="loading-modal-overlay">
        <div class="loading-modal-content">
            <div class="spinner"></div>
            <p>Capturando configuración, por favor espere...</p>
        </div>
    </div>

    <!-- ======================================================= -->
    <!-- NUEVO: Añadir los scripts del mapa aquí, ANTES de app.js -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-rotatedmarker@0.2.0/leaflet.rotatedMarker.min.js"></script>
    <!-- ======================================================= -->

    <script type="module" src="/web/js/app.js"></script>
</body>
</html>
