<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LC4 Programmer</title>
    <link rel="stylesheet" href="/web/css/style.css">

    <link rel="stylesheet" href="/web/lib/leaflet/leaflet.css" />
    </head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="/assets/img/cormar_logo.png" alt="Logo Cormar" class="sidebar-logo">
                <span>LC4 Programmer</span>
                <button class="back-button" onclick="goBackToWelcome()" title="Volver a la pantalla de inicio">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                </button>
            </div>
            <nav class="sidebar-nav">
                <a href="#" id="nav-dashboard" class="active" onclick="loadView('dashboard')">Dashboard</a>
                <a href="#" id="nav-sequences" onclick="loadView('sequences')">Editor de Secuencias</a> 
                <a href="#" id="nav-plans" onclick="loadView('plans')">Programador de Planes</a>
                <a href="#" id="nav-config" onclick="loadView('config')">Configuración</a>
                <a href="#" id="nav-monitoring" onclick="loadView('monitoring')">Monitoreo en Tiempo Real</a>
                <a href="#" id="nav-plan-visualizer" onclick="loadView('plan-visualizer')">Visualizador de Planes</a>
            </nav>
            <div class="sidebar-footer">
                <a href="#" onclick="handleSaveGlobal()">Guardar Global</a>
                <a href="#" id="btn-upload" class="sidebar-link-disabled" onclick="handleUpload()">Subir al Controlador</a>
                <a href="#" id="btn-factory-reset" class="sidebar-link-disabled" onclick="handleFactoryReset()">Restablecer de Fábrica</a>
                <a href="#" id="btn-disconnect-app" onclick="handleAppDisconnect()">Desconectar</a>
                <div id="app-status-indicator" class="status-indicator disconnected">
                    Desconectado
                </div>
            </div>
        </aside>

        <main id="main-content-area" class="main-content">
            </main>
    </div>
    <div id="loading-modal" class="loading-modal-overlay">
        <div class="loading-modal-content">
            <div class="spinner"></div>
            <p>Capturando configuración, por favor espere...</p>
        </div>
    </div>

    <script src="/web/lib/leaflet/leaflet.js"></script>
    <script src="/web/lib/leaflet/leaflet.rotatedMarker.min.js"></script>
    <script type="module" src="/web/js/app.js"></script>

    
    <div id="add-movement-modal" class="modal-overlay">
        <div class="modal-content">
            <h4 id="modal-title">Añadir Movimiento a Secuencia X</h4>
            <div id="modal-step-1">
                <p>¿Qué deseas hacer?</p>
                <div class="modal-options">
                    <button id="modal-btn-new">Crear Movimiento Nuevo</button>
                    <button id="modal-btn-existing">Añadir Movimiento Existente</button>
                </div>
            </div>
            <div id="modal-step-2" style="display: none;">
                <p>Selecciona un movimiento de la lista para añadirlo a la secuencia.</p>
                <select id="modal-select-movement"></select>
                <div class="modal-actions">
                    <button id="modal-btn-add-selected">Añadir Seleccionado</button>
                </div>
            </div>
            <div class="modal-footer">
                <button id="modal-btn-cancel">Cancelar</button>
            </div>
        </div>
    </div>
  

    <div id="factory-reset-modal" class="modal-overlay">
        <div class="modal-content">
            <h4 class="modal-title-warning">¡Acción Destructiva!</h4>
            <p>Estás a punto de **borrar permanentemente toda la configuración** del controlador conectado. Esta acción no se puede deshacer.</p>
            <p>Para confirmar, por favor escribe la frase <strong>BORRAR TODO</strong> en el campo de abajo.</p>
            <div class="form-group">
                <input type="text" id="factory-reset-confirm-input" autocomplete="off">
            </div>
            <div class="modal-actions">
                <button id="factory-reset-cancel-btn">Cancelar</button>
                <button id="factory-reset-confirm-btn" class="delete-btn" disabled>Confirmar Reseteo</button>
            </div>
        </div>
    </div>
    <script type="module" src="/web/js/app.js"></script>
</body>
</html>